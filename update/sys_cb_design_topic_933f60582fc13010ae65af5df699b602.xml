<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_design_topic">
    <sys_cb_design_topic action="INSERT_OR_UPDATE">
        <compiled_topic display_value="Submit a Request">1b3f20582fc13010ae65af5df699b6fd</compiled_topic>
        <design_definition>{"type":"FlowTopic","triggers":[{"type":"Trigger","name":"5249fee80f874fde8199cb69efd70722","triggerType":"request","applicability":{"type":"Applicability","mode":"script","value":"true"},"id":"5249fee80f874fde8199cb69efd70722"}],"goals":[{"name":"primary","trigger_id":"5249fee80f874fde8199cb69efd70722","nodes":[{"type":"StartGoal","goal_id":"primary","greeting_msg":{"type":"String","mode":"string","value":""},"id":"9299480c84ad497a92db84a57e6a2212","name":"Start"},{"type":"TerminateGoal","goal_id":"primary","confirmation_msg":{"type":"String","mode":"string","value":""},"id":"a75aff70acee4c0692966be0b0e9e6a4","name":"End"},{"type":"LibraryCall","library_topic_name":"Search Catalog Item","library_topic_id":"ccaacd71c3a3330012d1758a7ff57ecd","parameter-mappings":[{"parameter-name":"catalogs","value":{"type":"String","mode":"string","value":"{{vaVars.catalogs_tobe_searched}}"}},{"parameter-name":"query_term","value":{"type":"String","mode":"string","value":"{{vaInputs.search_term}}"}}],"return-value-mappings":[{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"catalog_item_id","main_topic_mapped_variable_name":"catalog_item_id"},{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"item_type","main_topic_mapped_variable_name":"item_type"},{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"is_conversational","main_topic_mapped_variable_name":"is_conversational"}],"id":"8ce5a7cde0a249fc858436b171eba427","name":"Search Catalog Item","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"InputPrompt","variable_id":"037eed9a3447430996feb282aefe1f68","message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"What are you looking for?\", vaContext.getRequesterLang())"},"nlu_entity_binding":{"type":"NLUEntityBinding","allow_text_input":true,"use_confirmation_prompt":false},"skippable":{"type":"Applicability","mode":"script","value":"false"},"id":"5b184fce1c694bb98dd82eb7f9f9f835","name":"Search Term","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"formatType":"Text","validationScript":""},{"type":"LinkOutputPrompt","header":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Please click on the link below to complete the request:\", vaContext.getRequesterLang())"},"label":{"type":"String","mode":"script","value":"(function execute() {\n    return JSON.parse(vaVars.selected_item).title;\n})()\n"},"url":{"type":"String","mode":"script","value":"(function execute() {\n    return vaVars.baseUri+JSON.parse(vaVars.selected_item).selected_link;\n})()\n"},"link_type":"single","multi_link_script":"","id":"61c40ba7cc99413dbe456afc2cc1722c","name":"Display link","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n        var catItemObj = new sn_sc.CatItem(vaInputs.catalog_item_id);\n        var catItemJson = catItemObj.read({\n            \"name\" : \"\"\n        }, true);\n        var itemJSON = {'sys_id': vaInputs.catalog_item_id, 'title': catItemJson.name, 'selected_link':''};\n        if(vaVars.portal == null)\n            itemJSON.selected_link = vaVars.default_portal;\n        else\n            itemJSON.selected_link = vaVars.portal;\n        itemJSON.selected_link = itemJSON.selected_link + '?id=sc_cat_item&amp;sys_id=' + vaInputs.catalog_item_id;\n        vaVars.selected_item = JSON.stringify(itemJSON);\n})()\n","id":"8da1cb777ec54371a45146d710751e73","name":"Fetch Catalog Info","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"InputPrompt","variable_id":"ed1ce22cf3044279b476d5fb2f763725","message":{"type":"String","mode":"script","value":"(function execute() {\n    return gs.getMessage('Do you want to proceed with \\'{0}\\'?', [JSON.parse(vaVars.selected_item).title]);\n})()\n"},"nlu_entity_binding":{"type":"NLUEntityBinding","allow_text_input":false,"use_confirmation_prompt":true},"skippable":{"type":"Applicability","mode":"script","value":"false"},"id":"bd65cff9531146f89cadb870d7272920","name":"Proceed","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"Yes","expression":{"type":"Applicability","mode":"query","value":"proceed=true"},"id":"0e952127eb1b45498e26c661d589d29d","name":"Yes"},{"type":"Branch","label":"No","expression":{"type":"Applicability","mode":"query","value":"proceed="},"id":"dfdd7bf7ea50499ab2d58a61005a11a9","name":"No"}],"id":"a1d0a1b1bb824442a315472345eb406f","goal_id":"primary"},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Okay, let's try again\", vaContext.getRequesterLang())"},"id":"6dc51ff3b087412a819b0dc3dc8b2433","name":"Try again","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"secure":false},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"Catalog item selected","expression":{"type":"Applicability","mode":"query","value":"catalog_item_idISNOTEMPTY"},"id":"d07a61658cb943738cd05d6ac4fa4f0b","name":"Catalog item selected"},{"type":"Branch","label":"No Catalog selected","expression":{"type":"Applicability","mode":"query","value":"catalog_item_idISEMPTY"},"id":"b16ee745a2314e0d8c95fda25f448e57","name":"No Catalog selected"}],"id":"ac5bd6e7860c487b98c2787aaf5d3dac","goal_id":"primary"},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Sorry, but I couldn't find any relevant items.\", vaContext.getRequesterLang())"},"id":"d6cf52cfbb32451a8f4961217d4e944c","name":"No Catalog items ack","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"secure":false},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"true","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return (!gs.nil(vaVars.catalogs_tobe_searched) &amp;&amp; !gs.nil(vaVars.portal)) || gs.nil(vaVars.portal);\n})()\n"},"id":"a430f60821d947f0826ea820a450dd73","name":"true"},{"type":"Branch","label":"false","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return (gs.nil(vaVars.catalogs_tobe_searched) &amp;&amp; !gs.nil(vaVars.portal));\n})()\n"},"id":"1bab1c2b1d004e859826674592401de0","name":"false"}],"id":"fe8330b7dc534c20a0459583a87ae071","goal_id":"primary"},{"type":"ScriptedAction","script":"(function execute() {\n    var catalogArray = [];\n    if(!gs.nil(vaVars.portal)) {\n        var portal_catalog = new GlideRecord('m2m_sp_portal_catalog');\n        portal_catalog.addQuery('sp_portal.url_suffix', vaVars.portal);\n        portal_catalog.addActiveQuery();\n        portal_catalog.query();\n        \n        while (portal_catalog.next()) {\n            catalogArray.push(portal_catalog.getValue('sc_catalog'));\n        }\n    }\n    vaVars.catalogs_tobe_searched = catalogArray.join();\n})()\n","id":"7b71746c1e9043a1b615884d2d70812b","name":"Portal Catalogs","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}}],"edges":[{"type":"Edge","source_node_id":"9299480c84ad497a92db84a57e6a2212","target_node_id":"5b184fce1c694bb98dd82eb7f9f9f835","id":"91fa0cbd7abf4f669a44f4d1e6496383"},{"type":"Edge","source_node_id":"8da1cb777ec54371a45146d710751e73","target_node_id":"bd65cff9531146f89cadb870d7272920","id":"7659d85aa23f4edca79be89d3740d1d7"},{"type":"Edge","source_node_id":"61c40ba7cc99413dbe456afc2cc1722c","target_node_id":"a75aff70acee4c0692966be0b0e9e6a4","id":"ced40187dcf343ce96ad066303279cb5"},{"type":"Edge","source_node_id":"bd65cff9531146f89cadb870d7272920","target_node_id":"a1d0a1b1bb824442a315472345eb406f","id":"21c50346a2754a4e93dd70e038e30804"},{"type":"Edge","source_node_id":"a1d0a1b1bb824442a315472345eb406f","target_node_id":"61c40ba7cc99413dbe456afc2cc1722c","branch_id":"0e952127eb1b45498e26c661d589d29d","id":"a515c80364ed40998b3765eb649913db","name":"0e952127eb1b45498e26c661d589d29d"},{"type":"Edge","source_node_id":"a1d0a1b1bb824442a315472345eb406f","target_node_id":"6dc51ff3b087412a819b0dc3dc8b2433","branch_id":"dfdd7bf7ea50499ab2d58a61005a11a9","id":"9c1f73c39048476f8f5d03cbad7ae1ff","name":"dfdd7bf7ea50499ab2d58a61005a11a9"},{"type":"Edge","source_node_id":"6dc51ff3b087412a819b0dc3dc8b2433","target_node_id":"5b184fce1c694bb98dd82eb7f9f9f835","id":"04ea7752dbad4e8ba7c2faa9b5ab1050"},{"type":"Edge","source_node_id":"8ce5a7cde0a249fc858436b171eba427","target_node_id":"ac5bd6e7860c487b98c2787aaf5d3dac","id":"b34f567089c84935850b838f7c0699bb"},{"type":"Edge","source_node_id":"d6cf52cfbb32451a8f4961217d4e944c","target_node_id":"a75aff70acee4c0692966be0b0e9e6a4","id":"1f754787155e4783b3d380da996ede69"},{"type":"Edge","source_node_id":"ac5bd6e7860c487b98c2787aaf5d3dac","target_node_id":"8da1cb777ec54371a45146d710751e73","branch_id":"d07a61658cb943738cd05d6ac4fa4f0b","id":"1ff9854d83ea452cb7a4cb2720867b07","name":"d07a61658cb943738cd05d6ac4fa4f0b"},{"type":"Edge","source_node_id":"ac5bd6e7860c487b98c2787aaf5d3dac","target_node_id":"d6cf52cfbb32451a8f4961217d4e944c","branch_id":"b16ee745a2314e0d8c95fda25f448e57","id":"2139ef6696df4acd94f4f9cb6e023823","name":"b16ee745a2314e0d8c95fda25f448e57"},{"type":"Edge","source_node_id":"fe8330b7dc534c20a0459583a87ae071","target_node_id":"8ce5a7cde0a249fc858436b171eba427","branch_id":"a430f60821d947f0826ea820a450dd73","id":"14b35c89a32343d597a487071c66e17f","name":"a430f60821d947f0826ea820a450dd73"},{"type":"Edge","source_node_id":"fe8330b7dc534c20a0459583a87ae071","target_node_id":"d6cf52cfbb32451a8f4961217d4e944c","branch_id":"1bab1c2b1d004e859826674592401de0","id":"181915cbb8bc4ed08503724648b0a4ed","name":"1bab1c2b1d004e859826674592401de0"},{"type":"Edge","source_node_id":"5b184fce1c694bb98dd82eb7f9f9f835","target_node_id":"7b71746c1e9043a1b615884d2d70812b","id":"7a00035caeb5407a8f3fd713e170685f"},{"type":"Edge","source_node_id":"7b71746c1e9043a1b615884d2d70812b","target_node_id":"fe8330b7dc534c20a0459583a87ae071","id":"6933d8fb24004dc792291d14735dc22c"}],"id":"primary"}],"script_variables":[{"type":"String","name":"selected_item","value":{"type":"String","mode":"string"},"id":"9d99223f5add49289446c199a9a44ab2","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"portal","value":{"type":"String","mode":"script","value":"(function execute() {\n    return vaContext.portal == undefined ? null : vaContext.portal;\n})()"},"id":"ac44196b030043a69712129b3fdd43cc","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"default_portal","value":{"type":"String","mode":"string","value":"csm"},"id":"e680a9f94417451a8358227113553508","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"baseUri","value":{"type":"String","mode":"script","value":"(function execute() {\n    return gs.getProperty('glide.servlet.uri');\n})()\n"},"id":"5f17dd899faf475c8b74de65745f7444","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"catalogs_tobe_searched","value":{"type":"String","mode":"string"},"id":"9dcbcfbc85f74a95a7829bd08cc2dd82","formatType":"text","secure":false,"sensitive":false}],"glide_variables":[{"type":"String","name":"search_term","id":"037eed9a3447430996feb282aefe1f68","formatType":"Text","validationScript":"","secure":false,"sensitive":false},{"type":"True/False","id":"ed1ce22cf3044279b476d5fb2f763725","name":"proceed","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"catalog_item_id","id":"34f1743da30043a6a03fd44981ae395e","formatType":"text","metadata":{"libraryMappingType":"output"},"secure":false,"sensitive":false},{"type":"String","name":"item_type","id":"40b8ac684296407f92e8c28d107fff86","formatType":"text","metadata":{"libraryMappingType":"output"},"secure":false,"sensitive":false},{"type":"String","name":"is_conversational","id":"51b720e270614c568fba26fe196a6a4f","formatType":"text","metadata":{"libraryMappingType":"output"},"secure":false,"sensitive":false},{"type":"Reference","table":"sys_user","id":"c3cee4a654da4c8ebfa787aab53c34f1","name":"user","formatType":"text","secure":false,"sensitive":false}],"applicability":{"type":"Applicability","mode":"script","value":"true"},"roles":["admin","virtual_agent_admin","sn_customerservice.customer","sn_customerservice.consumer"],"scope":"6ead8e780f603200cd674f8ce1050ed1","domain":"global","topic_type":"STANDARD","channels":[],"id":"29eeecd42fc13010ae65af5df699b63b","name":"Submit a Request","key_phrases":["Submit a Request","Submit Request"],"nlu_provider":"","nlu_model":"","nlu_model_label":"","nlu_intent":"","nlu_intent_label":"","flexible_conversation_switching":false,"design_categories":[{"name":null,"visible":false,"sysId":"b28634c4b7b93300da7ab948ee11a93a"}],"triggerable_by_notification":false,"auto_resolution_enabled":false,"library":false,"nluMapping":"[]"}</design_definition>
        <design_topic_id>29eeecd42fc13010ae65af5df699b63b</design_topic_id>
        <name>Submit a Request</name>
        <sys_class_name>sys_cb_design_topic</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2021-06-25 14:39:35</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>933f60582fc13010ae65af5df699b602</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>FlowTopic</sys_name>
        <sys_package display_value="NeedIt" source="x_58872_needit">6ead8e780f603200cd674f8ce1050ed1</sys_package>
        <sys_policy/>
        <sys_scope display_value="NeedIt">6ead8e780f603200cd674f8ce1050ed1</sys_scope>
        <sys_update_name>sys_cb_design_topic_933f60582fc13010ae65af5df699b602</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2021-06-25 14:39:35</sys_updated_on>
        <type>FlowTopic</type>
    </sys_cb_design_topic>
</record_update>
